!function(){"use strict";Polymer({is:"main-page",properties:{clothCount:{type:Number,value:14},size:{type:Number,value:6},numColors:{type:Number,value:12},useDmcColors:{type:Boolean,value:!1},hideTheGrid:{type:Boolean,value:!1},highQualityMode:{type:Boolean,value:!1},imageHash:{type:String,observer:"loadImage"},imageData:{type:Array},gridWidth:{type:Number,computed:"calcGridWidth(clothCount, size)"},packedOptions:{type:Number,observer:"unpackOptions"},urlHelper:{type:Object}},ready:function(){var e=this;console.log(this.size),console.log(this.numColors),this.urlHelper=new UrlHelper,this.addEventListener("crossStitchDone",function(){e.$.saveButton.disabled=!1,e.$.newTabButton.disabled=!1,e.$.printButton.disabled=!1,e.$.shareButton.disabled=!1})},loadImage:function(){var e=this;void 0!==this.imageHash&&this.imageHash.length>3&&this.urlHelper.getImageDataFromHash(this.imageHash).then(function(t){e.imageData=t})},unpackOptions:function(){var e=this.urlHelper.unpackOptions(this.packedOptions);this.useDmcColors=e.useDmcColors,this.hideTheGrid=e.hideTheGrid,this.highQualityMode=e.highQualityMode},calcGridWidth:function(e,t){return e*t},saveImage:function(){this.$.crossStitchElement.saveAsImage()},getImageAsDataURI:function(e){var t=new Image;return t.src=e.getImageAsURI(),t.style["image-rendering"]="pixelated",t.style.display="block",t},openNewTab:function(){var e=this.getImageAsDataURI(this.$.crossStitchElement);e.style.width="100%";var t=this.$.imagePalette.getColorKey();t.style.width="100%";var i=document.createElement("div");i.innerHTML=e.outerHTML+t.outerHTML;var a=window.open("");a.document.write(i.outerHTML)},shareImage:function(){this.$.imgurUpload.openShareDialog()},printImage:function(){var e=this.getImageAsDataURI(this.$.crossStitchElement);e.style.height="auto",e.style.width="auto",e.style.maxHeight="100%",e.style.maxWidth="100%",e.style.marginLeft="auto",e.style.marginRight="auto",e.style.marginTop="0",e.style.marginBottom="0";var t=this.$.imagePalette.getColorKey();t.style.width="100%";var i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.margin="0",i.innerHTML=e.outerHTML+t.outerHTML;var a=window.open("");a.document.write(i.outerHTML),a.focus(),a.print()},_getImageDataFromHash:function(e,t){var i="//i.imgur.com/"+e+".jpg",a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var e=document.createElement("canvas");e.width=this.width,e.height=this.height;var i=e.getContext("2d");i.drawImage(this,0,0),t(i.getImageData(0,0,e.width,e.height))},a.src=i}})}();