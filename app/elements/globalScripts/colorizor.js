class Colorizor {

  /**
   * Creates the object
   */
  constructor(){
    this._dmcColorMap = this._getDmcColorMap();
  }

  /**
   * Gets an array of the DMC colors as RGB
   *
   * @return {Array} Each element is an RGB tuple [r,g,b] of 0-255 each value
   */
  getColorsAsRGB() {
    let rgbTuple = [];
    this._dmcColorMap.forEach((dmcColor, hexColor)=>{
      rgbTuple.push(this.convertHexToRGB(hexColor));
    });

    return rgbTuple;
  }

  /**
   * Gets the Dmc Color Map
   *
   * @return {Map} The color map, key is Hex color, value is DMC number
   */
  getDmcColorMap(){
    return this._dmcColorMap;
  }

  /**
   * Converts a given hex color into an RGB array
   *
   * @param  {string} hex a 6 character string of the hex value of the color
   *                      no "#" in front
   * @return {array}      [r,g,b] array of 0-255 each
   */
  convertHexToRGB(hex){
    const bigint = parseInt(hex.toLowerCase(), 16);
    const r = (bigint >> 16) & 255;
    const g = (bigint >> 8) & 255;
    const b = bigint & 255;

    return [r, g, b];
  }

  /**
   * Converts the given RGB value into a hex string
   *
   * @param  {Array} [r,g,b] an array of 0-255 RGB values
   * @return {string}        a 6 character string of the hex value of the color
   *                         all lower case, no "#" in the front
   */
  convertRGBToHex([r, g, b]){
    //This is black magic, just turn back now!
    return ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
  }

  /**
   * Moved this to a function at the bottom to avoid mucking up the constructor with it
   *
   * @return {Map} Map of DMC Colors (hex is the key, dmc number is the value)
   */
  _getDmcColorMap(){
    return new Map([
      ['FFFFFF', '000'], ['945B80', '208'], ['CE94BA', '209'], ['ECCFE1', '210'], ['F3DAE4', '211'],
      ['9C294A', '221'], ['DB8073', '223'], ['FFC7B0', '224'], ['FFF0E4', '225'], ['8F3926', '300'],
      ['D16654', '301'], ['BC0061', '304'], ['FFE76D', '307'], ['D62B5B', '309'], ['000000', '310'],
      ['004F61', '311'], ['3A5467', '312'], ['A35A5B', '315'], ['DC8D8D', '316'], ['A78B88', '317'],
      ['C5C6BE', '318'], ['555F52', '319'], ['8A9978', '320'], ['E71261', '321'], ['516D87', '322'],
      ['BC1641', '326'], ['3D0067', '327'], ['7F5482', '333'], ['738CAA', '334'], ['DB244F', '335'],
      ['244967', '336'], ['A279A4', '340'], ['91B4C5', '341'], ['C22443', '347'], ['DC3D5B', '349'],
      ['ED455A', '350'], ['FF8087', '351'], ['FF9D90', '352'], ['FFC4B8', '353'], ['BD492F', '355'],
      ['E2725B', '356'], ['5F705B', '367'], ['B5CEA2', '368'], ['F3FAD1', '369'], ['B88A57', '370'],
      ['C49B64', '371'], ['CBA26B', '372'], ['9D3C27', '400'], ['FFBEA4', '402'], ['C2654C', '407'],
      ['6D5F5F', '413'], ['A78B88', '414'], ['DDDDDA', '415'], ['8C5B2B', '420'], ['EDAC7B', '422'],
      ['975414', '433'], ['B26746', '434'], ['BB6B39', '435'], ['E79873', '436'], ['EEAB79', '437'],
      ['FFB000', '444'], ['FFFFBE', '445'], ['B3978F', '451'], ['D2B9AF', '452'], ['EBCFB9', '453'],
      ['74725C', '469'], ['858F6C', '470'], ['B0BB8C', '471'], ['EEFFB6', '472'], ['BB0061', '498'],
      ['2B3929', '500'], ['435549', '501'], ['869E86', '502'], ['C3CEB7', '503'], ['CEDDC1', '504'],
      ['107F87', '517'], ['66949A', '518'], ['C2D1CF', '519'], ['374912', '520'], ['9FA98E', '522'],
      ['ACB78E', '523'], ['CDB69E', '524'], ['555559', '535'], ['EFD6BC', '543'], ['6D1261', '550'],
      ['925582', '552'], ['A06492', '553'], ['F3CEE1', '554'], ['3B604C', '561'], ['618661', '562'],
      ['B6D4B4', '563'], ['D6E6CC', '564'], ['006700', '580'], ['979831', '581'], ['809784', '597'],
      ['D0DFCD', '598'], ['D0396A', '600'], ['DE3969', '601'], ['E7547A', '602'], ['FF738C', '603'],
      ['FFBDCA', '604'], ['FFCFD6', '605'], ['FF0000', '606'], ['FF5B00', '608'], ['976854', '610'],
      ['9E6D5B', '611'], ['CB9867', '612'], ['DBB07A', '613'], ['A24D34', '632'], ['A3A39D', '640'],
      ['AEB0AA', '642'], ['E0E0D7', '644'], ['717171', '645'], ['797979', '646'], ['BEBEB9', '647'],
      ['CACACA', '648'], ['D52756', '666'], ['FFCE9E', '676'], ['FFE7B6', '677'], ['D18C67', '680'],
      ['005B06', '699'], ['00602F', '700'], ['4F6C45', '701'], ['4F7942', '702'], ['79904C', '703'],
      ['A5A467', '704'], ['F5F0DB', '712'], ['DB3779', '718'], ['C8242B', '720'], ['FF7361', '721'],
      ['FF926D', '722'], ['FFC87C', '725'], ['FFE080', '726'], ['FFEBA8', '727'], ['F3B080', '729'],
      ['846600', '730'], ['8C6700', '731'], ['916800', '732'], ['CE9B61', '733'], ['DDA66B', '734'],
      ['F4C38B', '738'], ['F4E9CA', '739'], ['FF8313', '740'], ['FF8E04', '741'], ['FFB755', '742'],
      ['FFE692', '743'], ['FFEFAA', '744'], ['FFF0C5', '745'], ['F6EADB', '746'], ['F0F7EF', '747'],
      ['FBE3D1', '754'], ['FFB193', '758'], ['F9A092', '760'], ['FFC9BC', '761'], ['E8E8E5', '762'],
      ['E7F9CB', '772'], ['F7F6F8', '775'], ['FFB1AE', '776'], ['FFC7B8', '778'], ['B5622E', '780'],
      ['B56B38', '781'], ['CC7742', '782'], ['E19255', '783'], ['47375D', '791'], ['616180', '792'],
      ['938BA4', '793'], ['BBD0DA', '794'], ['1E3A5F', '796'], ['1E4263', '797'], ['67738D', '798'],
      ['849CB6', '799'], ['E9EEE9', '800'], ['7B4714', '801'], ['1E8285', '806'], ['80A7A0', '807'],
      ['BEC1CD', '809'], ['AFC3CD', '813'], ['A20058', '814'], ['A6005B', '815'], ['B3005B', '816'],
      ['DB1855', '817'], ['FFEAEB', '818'], ['F8F7DD', '819'], ['1E3655', '820'], ['F2EADB', '822'],
      ['000049', '823'], ['476174', '824'], ['556C80', '825'], ['738A99', '826'], ['D5E7E8', '827'],
      ['EDF7EE', '828'], ['825A08', '829'], ['885F12', '830'], ['906712', '831'], ['B27737', '832'],
      ['DBB680', '833'], ['F2D18E', '834'], ['5E381B', '838'], ['6D4227', '839'], ['80551E', '840'],
      ['BC866B', '841'], ['DBC2A4', '842'], ['6B6766', '844'], ['995C30', '868'], ['995C30', '869'],
      ['4F564C', '890'], ['F13154', '891'], ['F95A61', '892'], ['F3959D', '893'], ['FFC2BF', '894'],
      ['595C4E', '895'], ['763713', '898'], ['E96D73', '899'], ['CE2B00', '900'], ['8A184D', '902'],
      ['4E5F39', '904'], ['627739', '905'], ['8FA359', '906'], ['B9C866', '907'], ['316955', '909'],
      ['30745B', '910'], ['318061', '911'], ['739E73', '912'], ['99BC95', '913'], ['AA185B', '915'],
      ['AB165F', '917'], ['A8444C', '918'], ['B44B52', '919'], ['C55E58', '920'], ['CE675B', '921'],
      ['ED8673', '922'], ['566364', '924'], ['607473', '926'], ['C8C6C2', '927'], ['E1E0D8', '928'],
      ['667A8C', '930'], ['7C8791', '931'], ['B6BAC2', '932'], ['3E3B28', '934'], ['433F2F', '935'],
      ['454531', '936'], ['495637', '937'], ['632710', '938'], ['000031', '939'], ['00A275', '943'],
      ['FFCEA4', '945'], ['F44900', '946'], ['FF5B00', '947'], ['FFF3E7', '948'], ['EFA27F', '950'],
      ['FFE5BC', '951'], ['AAD5A4', '954'], ['D6E6CC', '955'], ['FF6D73', '956'], ['FFCCD0', '957'],
      ['00A082', '958'], ['ABCEB1', '959'], ['F36C7B', '961'], ['FD868D', '962'], ['FFE9E9', '963'],
      ['D0E0D2', '964'], ['CED5B0', '966'], ['FF7518', '970'], ['FF6A00', '971'], ['FF9200', '972'],
      ['FFC243', '973'], ['9E4312', '975'], ['F68D39', '976'], ['FFA449', '977'], ['3A5241', '986'],
      ['536149', '987'], ['86916E', '988'], ['86996E', '989'], ['2F5B49', '991'], ['92B7A5', '992'],
      ['C0E0C8', '993'], ['007B86', '995'], ['AADEE1', '996'], ['7B5B40', '3011'],['AA8667', '3012'],
      ['D0C3A4', '3013'],['735B5D', '3021'],['ACACAA', '3022'],['C6BEAD', '3023'],['D2D0CD', '3024'],
      ['543817', '3031'],['BC9C78', '3032'],['EFDBBE', '3033'],['BE9BA7', '3041'],['E1CDC8', '3042'],
      ['D89769', '3045'],['E5C18B', '3046'],['FFECD3', '3047'],['554900', '3051'],['898D72', '3052'],
      ['BBB394', '3053'],['C2654C', '3064'],['E9E9DF', '3072'],['FFFFDC', '3078'],['CAE2E5', '3325'],
      ['FF9D96', '3326'],['BC4055', '3328'],['FF7B67', '3340'],['EBACA2', '3341'],['616452', '3345'],
      ['78866B', '3346'],['809873', '3347'],['E1F9BE', '3348'],['C94F5B', '3350'],['FFD6D1', '3354'],
      ['605F54', '3362'],['747F60', '3363'],['A1A787', '3364'],['532510', '3371'],['E74F86', '3607'],
      ['F798B6', '3608'],['FFD6E5', '3609'],['A1354F', '3685'],['CB4E61', '3687'],['FA9790', '3688'],
      ['FFD5D8', '3689'],['FF555B', '3705'],['FF806D', '3706'],['FED4DB', '3708'],['E6656B', '3712'],
      ['FDE5D9', '3713'],['FFD3D4', '3716'],['B84B4D', '3721'],['B85958', '3722'],['C3767B', '3726'],
      ['FFC7C4', '3727'],['D15D67', '3731'],['FF9A94', '3733'],['9C7D85', '3740'],['EBEBE7', '3743'],
      ['9566A2', '3746'],['E6ECE8', '3747'],['0C5B6C', '3750'],['C2D1CE', '3752'],['EDF7F7', '3753'],
      ['9EB0CE', '3755'],['F8F8FC', '3756'],['668E98', '3760'],['E3EAE6', '3761'],['188086', '3765'],
      ['18656F', '3766'],['5C6E6C', '3768'],['FFFAE0', '3770'],['AD533E', '3772'],['E78667', '3773'],
      ['FFDCC1', '3774'],['DD6D5B', '3776'],['BF4024', '3777'],['ED7A64', '3778'],['FFB198', '3779'],
      ['71472A', '3781'],['CEAF90', '3782'],['8B6D73', '3787'],['8C756D', '3790'],['514C53', '3799']
    ]);
  }

}
